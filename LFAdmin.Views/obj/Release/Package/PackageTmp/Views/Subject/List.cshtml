<style>
        .layui-table .layui-table-cell {
            height: auto;
            overflow: visible;
            text-overflow: inherit;
            white-space: normal;
        }
    </style>
<div class="demoTable" style="padding-top:20px">
    &nbsp&nbsp
    问卷名称：
    <div class="layui-inline">
        <input class="layui-input" id="Subject_Name" autocomplete="off">
    </div>

    <button class="layui-btn" data-type="reload" id="search">搜索</button>
    <button class="layui-btn layui-btn-primary" data-type="add" id="add">添加</button>
    @*<button class="layui-btn layui-btn-primary" data-type="360" id="360">添加360</button>*@
</div>
<table id="subject" class="layui-table" lay-filter="subject" lay-data="{  height: 'full-80', cellMinWidth: 120, page: true, limit: 20, url:'/Subject/getList'}">
    <thead>
        <tr>
            <th lay-data="{type: 'numbers'}"></th>
            <th lay-data="{field:'Subject_Name', event: 'getSubject',width:350,  sort: true}">题目名称</th>
            <th lay-data="{field:'Subject_Type', event: 'getSubject',  sort: true}">题目类型</th>
            <th lay-data="{field:'Option_Code', event: 'getSubject',  sort: true}">答案编号</th>
            <th lay-data="{field:'Subject_Second_Type', event: 'getSubject',  sort: true}">二级分类</th>
            <th lay-data="{field:'Subject_First_Type', event: 'getSubject',  sort: true}">一级分类</th>
            <th lay-data="{field:'Subject_Zore_Type', event: 'getSubject',  sort: true}">大类</th>
            <th lay-data="{field:'Weight', event: 'getSubject',  sort: true}">权重</th>
            <th lay-data="{ width:118, align:'center', toolbar: '#bar'}"></th>
        </tr>
    </thead>
</table>

<script type="text/html" id="bar">
    <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>

<script type="text/javascript">

    layui.use(['table', 'layer', 'form'], function () {
        var table = layui.table;
        layer = layui.layer;
        form = layui.form;
        var $ = layui.$;
        form.render();
        //监听
        table.on('tool(subject)', function (obj) {
            var data = obj.data;
            if (obj.event === 'detail') { //预览


            } else if (obj.event === 'del') {
                layer.confirm('数据删除之后将无法恢复', function (index) {
                    $.ajax({
                        'type': 'post',
                        'url': '/Subject/DelInfo',
                        'data': {
                            ID: data.ID
                        },
                        success: function (data) {
                            var da = JSON.parse(data);
                            if (da.IsSuccess == "1") {
                                obj.del();
                                layer.close(index);
                                layer.alert(da.MessageString, {
                                    title: '提示'
                                });
                            }
                            else {
                                layer.alert(da.MessageString, {
                                    title: '提示'
                                });
                            }

                        },
                        error: function (message) {
                            layer.alert(JSON.stringify(message.statusText), {
                                title: '提示'
                            });
                        }

                    });

                   

                });
            } else if (obj.event === 'edit') {
                var id = data.ID;
                //页面层
                layer.open({
                    type: 2,
                    title: "编辑题目信息",
                    skin: 'layui-layer-rim', //加上边框
                    area: ['670px', '450px'], //宽高
                    content: '/Subject/Edit?ID=' + id
                });
            }

        });

        layer.ready(function () {
            //执行重载
            table.reload('subject', {
                page: {
                    curr: 1 //重新从第 1 页开始
                }
                , where: {
                    Subject_Name: $("#Subject_Name").val(),
                    time: new Date()
                }
            });
        });

        //搜索加载--数据表格重载
        var $ = layui.$, active = {
            reload: function () {
                //执行重载
                table.reload('subject', {
                    page: {
                        curr: 1 //重新从第 1 页开始
                    }
                    , where: {
                        Subject_Name: $("#Subject_Name").val(),
                        time: new Date()
                    }
                });
            }
        };

        $('#search').on('click', function () {
            ids = new Array();
            var type = $(this).data('type');
            active[type] ? active[type].call(this) : '';
        });


        //$('#add').on('click', function () {

        //    layer.open({
        //        type: 2,
        //        title: "新增题目信息",
        //        skin: 'layui-layer-rim', //加上边框
        //        area: ['430px', '200px'], //宽高
        //        content: '/Subject/Add'

        //    });
        //});

        $('#add').on('click', function () {
            layer.open({
                type: 2,
                title: "新增题目信息",
                skin: 'layui-layer-rim', //加上边框
                area: ['670px', '450px'], //宽高
                content: '/Subject/Add'
            });
        });


    });

</script>
