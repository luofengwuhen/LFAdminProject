@*<link href="~/Scripts/layui/css/layui.css" rel="stylesheet" />*@
@*<form class="layui-form" >*@
    <div class="demoTable" style="padding-top:20px;">
        <div class="layui-form">
            &nbsp&nbsp
            类型:
            <div class="layui-input-inline">
                <select id="typename" lay-filter="typename">
                    <option value=""></option>
                    <option value="公司">公司</option>
                    <option value="部门">部门</option>
                    <option value="岗位/职位">岗位/职位</option>
                    <option value="层级">层级</option>
                </select>
            </div>  
            <button class="layui-btn" data-type="reload" id="search">搜索</button>
            <button class="layui-btn layui-btn-primary" data-type="add" id="add">添加</button>
        </div>
    </div>
    <table id="basicdata" class="layui-table" lay-filter="basicdata" lay-data="{  height: 'full-80', cellMinWidth: 120,toolbar: '#toolbar', page: true, limit: 20, url:'/Basic/getList'}">
        <thead>
            <tr>
                <th lay-data="{type: 'numbers'}"></th>
                <th lay-data="{field:'Type',  sort: true}">类型</th>
                <th lay-data="{field:'Name',  sort: true}">名称</th>
                @*<th lay-data="{field:'Value',  sort: true}">值</th>*@
                <th lay-data="{field:'Memo', sort: true}">备注</th>
                <th lay-data="{ width:128, align:'center', toolbar: '#bar'}"></th> @**@
            </tr>
        </thead>
    </table>
    @*</form>*@

    @*<script src="~/Scripts/layui/layui.js"></script>*@
    <script type="text/html" id="toolbar">
        @*<div class="layui-btn-container">
                <button class="layui-btn layui-btn-sm" lay-event="getCheckData">获取选中行数据</button>
            </div>*@
    </script>

    <script type="text/html" id="bar">
        @*<a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">查看</a>*@
        <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
        <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
    </script>

    <script type="text/javascript">

        layui.use(['table', 'layer', 'form'], function () {
            var table = layui.table;
            layer = layui.layer;
            form = layui.form;
            var $ = layui.$;
            //头工具栏事件
            table.on('toolbar(basicdata)', function (obj) {
                var checkStatus = table.checkStatus(obj.config.id); //获取选中行状态
                switch (obj.event) {
                    case 'getCheckData':
                        var data = checkStatus.data;  //获取选中行数据
                        layer.alert(JSON.stringify(data));
                        break;
                };
            });


            //监听工具条
            table.on('tool(basicdata)', function (obj) {
                var data = obj.data;
                if (obj.event === 'detail') {
                    //layer.msg('ID：' + data.ID + ' 的查看操作');



                } else if (obj.event === 'del') {
                    layer.confirm('数据删除之后将无法恢复', function (index) {
                        $.ajax({
                            'type': 'post',
                            'url': '/Basic/DelInfo',
                            'data': {
                                ID: data.ID
                            },
                            success: function (data) {
                                var da = JSON.parse(data);
                                if (da.IsSuccess == "1") {
                                    obj.del();
                                    layer.close(index);
                                    layer.alert(da.MessageString, {
                                        title: '提示'
                                    });
                                }
                                else {
                                    layer.alert(da.MessageString, {
                                        title: '提示'
                                    });
                                }

                            },
                            error: function (message) {
                                layer.alert(JSON.stringify(message.statusText), {
                                    title: '提示'
                                });
                            }

                        }); 

                    });
                } else if (obj.event === 'edit') {
                    //layer.alert('编辑行：<br>' + JSON.stringify(data))

                    //layer.alert('ID：<br>' + )
                    var id = data.ID;
                    //页面层
                    layer.open({
                        type: 2,
                        title: "编辑信息",
                        skin: 'layui-layer-rim', //加上边框
                        area: ['450px', '420px'], //宽高
                        content: '/Basic/Edit?ID=' + id

                    });

                }
            });



            //搜索加载--数据表格重载
            var $ = layui.$, active = {
                reload: function () {
                    //执行重载
                    table.reload('basicdata', {
                        page: {
                            curr: 1 //重新从第 1 页开始
                        }
                        , where: {
                            typename: $("#typename").val(),
                            time: new Date()
                        }
                    });
                }
            };

            $('#search').on('click', function () {
                ids = new Array();
                var type = $(this).data('type');
                active[type] ? active[type].call(this) : '';
            });


            $('#add').on('click', function () {

                layer.open({
                    type: 2,
                    title: "新增信息",
                    skin: 'layui-layer-rim', //加上边框
                    area: ['450px', '420px'], //宽高
                    content: '/Basic/Add'

                });
            });


        });

    </script>
